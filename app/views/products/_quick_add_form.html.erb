<%# Quick Add Form - Simple form for adding product to cart %>

<%= form_with url: cart_cart_items_path,
              method: :post,
              class: "space-y-4",
              data: {
                controller: "cart-drawer",
                action: "turbo:submit-end->cart-drawer#open"
              } do |f| %>

  <%# Hidden field for product SKU %>
  <%= hidden_field_tag "cart_item[sku]", product.sku %>

  <%# Quantity selector - Show multiples of pack size %>
  <% pac_size = product.pac_size || 1 %>
  <div class="form-control">
    <label class="label">
      <span class="label-text font-semibold">Select quantity:</span>
      <span class="label-text-alt text-sm text-base-content/60">
        Pack size: <%= number_with_delimiter(pac_size) %> units
      </span>
    </label>
    <%# Value is number of packs, display shows "X packs (Y units)" %>
    <%= select_tag "cart_item[quantity]",
                   options_for_select((1..10).map { |num_packs|
                     total_units = num_packs * pac_size
                     ["#{num_packs} #{num_packs == 1 ? 'pack' : 'packs'} (#{number_with_delimiter(total_units)} units)", num_packs]
                   }, 1),
                   class: "select select-bordered w-full" %>
  </div>

  <%# Price display %>
  <div class="flex justify-between items-center py-3 px-4 bg-base-200 rounded-lg">
    <span class="font-medium">Price:</span>
    <span class="font-semibold text-lg">
      <%= number_to_currency(product.price) %>
    </span>
  </div>

  <%# Submit button %>
  <%= f.submit "Add to Cart", class: "btn btn-primary w-full mt-4" %>
<% end %>
