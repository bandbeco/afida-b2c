<%# Save address prompt - shown to logged-in users who used a new address %>
<%# Only display if user doesn't already have this address saved %>

<div class="bg-gray-50 border border-gray-200 rounded-lg p-6 mb-8"
     data-testid="save-address-prompt"
     data-controller="save-address-prompt">
  <h3 class="text-lg text-gray-800 text-center mb-8">Save this address for faster checkout</h3>

  <div class="flex flex-col sm:flex-row gap-4">
    <%# Address display %>
    <div class="flex-1 bg-white rounded-lg p-3 border border-gray-100 text-sm text-gray-700">
      <p class="font-medium text-gray-900"><%= order.shipping_name %></p>
      <p><%= order.shipping_address_line1 %><%= ", #{order.shipping_address_line2}" if order.shipping_address_line2.present? %></p>
      <p><%= order.shipping_city %>, <%= order.shipping_postal_code %></p>
    </div>

    <%# Form %>
    <%= form_with url: create_from_order_account_addresses_path, method: :post, class: "flex-1 flex flex-col gap-3", data: { turbo_frame: "_top" } do |f| %>
      <%= f.hidden_field :order_id, value: order.id %>

      <%= f.text_field :nickname,
            placeholder: "Name this address (e.g. Office)",
            class: "input input-bordered w-full",
            required: true,
            "aria-label": "Address nickname" %>

      <div class="flex gap-2">
        <%= f.submit "Save Address", class: "btn btn-primary" %>
      </div>
    <% end %>
  </div>
</div>
