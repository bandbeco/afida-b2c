<%# Turbo Stream response for removing a sample from cart %>

<%# Update the product card to show "Add" state (samples page) %>
<%= turbo_stream.replace dom_id(@product, :sample),
      partial: "samples/product_card",
      locals: { product: @product, in_cart: false, at_limit: @at_limit } %>

<%# Update sample counter (samples page) %>
<%= turbo_stream.replace "sample_counter",
      partial: "samples/sample_counter",
      locals: { sample_count: @sample_count } %>

<%# Update category header with new selected count (samples page) %>
<%= turbo_stream.replace dom_id(@category, :sample_header),
      partial: "samples/category_header",
      locals: { category: @category, selected_count: @category_selected_count } %>

<%# Update cart counter %>
<%= turbo_stream.replace "cart_counter", partial: "shared/cart_counter" %>

<%# Update cart items list (cart page) %>
<%= turbo_stream.update "cart" do %>
  <%= render partial: "cart_items/index", locals: { cart_items: Current.cart.cart_items.includes(:product).order('products.name ASC') } %>
<% end %>

<%# Update cart totals (cart page) %>
<%= turbo_stream.update "vat" do %>
  <%= number_to_currency(Current.cart.vat_amount) %>
<% end %>

<%= turbo_stream.update "subtotal" do %>
  <%= number_to_currency(Current.cart.subtotal_amount) %>
<% end %>

<%= turbo_stream.update "grand_total" do %>
  <%= number_to_currency(Current.cart.total_amount) %>
<% end %>
