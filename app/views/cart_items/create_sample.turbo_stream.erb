<%# Turbo Stream response for adding a sample to cart %>

<%# Update the product card to show "Added" state %>
<%= turbo_stream.replace dom_id(@product, :sample),
      partial: "samples/product_card",
      locals: { product: @product, in_cart: true, at_limit: @at_limit } %>

<%# Update sample counter %>
<%= turbo_stream.replace "sample_counter",
      partial: "samples/sample_counter",
      locals: { sample_count: @sample_count } %>

<%# Update category header with new selected count %>
<%= turbo_stream.replace dom_id(@category, :sample_header),
      partial: "samples/category_header",
      locals: { category: @category, selected_count: @category_selected_count } %>

<%# Update cart counter %>
<%= turbo_stream.replace "cart_counter", partial: "shared/cart_counter" %>

<%# GA4 E-commerce: add_to_cart event for samples (value = 0) %>
<%= turbo_stream.append_all "head" do %>
  <script>
    <%= ecommerce_add_to_cart_event(@product, quantity: 1, value: 0) %>
  </script>
<% end %>
