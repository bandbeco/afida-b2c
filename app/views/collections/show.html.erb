<% content_for :breadcrumbs do %>
  <nav aria-label="Breadcrumb" class="text-sm breadcrumbs">
    <ul>
      <li><%= link_to "Home", root_path %></li>
      <li><%= link_to "Collections", collections_path %></li>
      <li><%= @collection.name %></li>
    </ul>
  </nav>
<% end %>

<% content_for :title do %>
<%= collection_meta_title(@collection) %>
<% end %>

<% content_for :meta_description do %>
<%= collection_meta_description(@collection) %>
<% end %>

<% if @collection.image.attached? %>
  <% content_for :og_image, url_for(@collection.image) %>
<% end %>

<% content_for :og_tags_custom, true %>
<% content_for :twitter_tags_custom, true %>
<% content_for :head do %>
  <%= canonical_url(collection_url(@collection)) %>
  <meta property="og:type" content="website">
  <meta property="og:title" content="<%= collection_meta_title(@collection) %>">
  <meta property="og:description" content="<%= collection_meta_description(@collection) %>">
  <meta property="og:url" content="<%= collection_url(@collection) %>">
  <meta property="og:site_name" content="Afida">
  <meta property="og:image" content="<%= @collection.image.attached? ? url_for(@collection.image) : hero_image_url %>">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="<%= collection_meta_title(@collection) %>">
  <meta name="twitter:description" content="<%= collection_meta_description(@collection) %>">

  <script type="application/ld+json">
    <%= raw(collection_structured_data(@collection).to_json) %>
  </script>
<% end %>

<div class="drawer drawer-end">
  <input id="cart-drawer" type="checkbox" class="drawer-toggle" aria-label="Toggle shopping cart" />
  <div class="drawer-content">

    <h1 class="text-4xl mb-4"><%= @collection.name %></h1>

    <% if @collection.description.present? %>
      <div class="prose prose-sm max-w-none mb-6">
        <%= @collection.description %>
      </div>
    <% end %>

    <div class="min-h-[60vh]">
      <% if @products.any? %>
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
          <%= render partial: "products/card", collection: @products, as: :product %>
        </div>
      <% else %>
        <div class="text-center py-16">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-base-content/30 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
          </svg>
          <h2 class="text-xl font-medium mb-2">No products in this collection</h2>
          <p class="text-base-content/70 mb-4">Check back soon as we add more products.</p>
          <%= link_to "Browse All Products", shop_path, class: "btn btn-primary" %>
        </div>
      <% end %>
    </div>

  </div>

  <div class="drawer-side">
    <label for="cart-drawer" aria-label="close sidebar" class="drawer-overlay"></label>
    <div class="bg-base-200 text-base-content h-full w-80 p-4 flex flex-col">
      <%= render "shared/drawer_cart_content" %>
    </div>
  </div>
</div>
